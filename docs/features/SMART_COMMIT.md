# æ™ºèƒ½æäº¤ (Smart Commit)

## åŠŸèƒ½æ¦‚è¿°

GitAI çš„æ™ºèƒ½æäº¤åŠŸèƒ½é€šè¿‡ AI åˆ†æä»£ç å˜æ›´ï¼Œè‡ªåŠ¨ç”Ÿæˆç¬¦åˆè§„èŒƒçš„æäº¤ä¿¡æ¯ï¼Œå¹¶æ”¯æŒä¸ Issue å…³è”ï¼Œæå‡æäº¤è´¨é‡å’Œå¼€å‘æ•ˆç‡ã€‚

## æ ¸å¿ƒç‰¹æ€§

### 1. AI ç”Ÿæˆæäº¤ä¿¡æ¯
- è‡ªåŠ¨åˆ†æä»£ç å˜æ›´å†…å®¹
- ç”Ÿæˆç¬¦åˆ Conventional Commits è§„èŒƒçš„æäº¤ä¿¡æ¯
- æ”¯æŒå¤šè¯­è¨€ä»£ç ç†è§£
- æ™ºèƒ½è¯†åˆ«å˜æ›´ç±»å‹ï¼ˆfeat/fix/docs/style/refactor/test/choreï¼‰

### 2. Issue å…³è”
- è‡ªåŠ¨æå–ç›¸å…³ Issue ID
- åœ¨æäº¤ä¿¡æ¯ä¸­æ·»åŠ  Issue å¼•ç”¨
- æ”¯æŒå¤šä¸ª Issue å…³è”
- å…¼å®¹å¤šç§ Issue æ ¼å¼ï¼ˆ#123, JIRA-456ï¼‰

### 3. ä»£ç è¯„å®¡é›†æˆ
- æäº¤å‰å¯é€‰ä»£ç è¯„å®¡
- è‡ªåŠ¨æ£€æŸ¥ä»£ç è´¨é‡
- è¯†åˆ«æ½œåœ¨é—®é¢˜
- æä¾›æ”¹è¿›å»ºè®®

### 4. çµæ´»çš„å·¥ä½œæ¨¡å¼
- æ”¯æŒæ‰‹åŠ¨æŒ‡å®šæäº¤ä¿¡æ¯
- æ”¯æŒ AI è¾…åŠ©å¢å¼º
- æ”¯æŒ dry-run æ¨¡å¼é¢„è§ˆ
- æ”¯æŒè‡ªåŠ¨æš‚å­˜æ–‡ä»¶

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ç”¨æ³•

```bash
# AI è‡ªåŠ¨ç”Ÿæˆæäº¤ä¿¡æ¯
gitai commit

# æŒ‡å®šæäº¤ä¿¡æ¯
gitai commit -m "fix: resolve memory leak in parser"

# å…³è” Issue
gitai commit --issue-id "#123,#456"

# æäº¤å‰è¿›è¡Œä»£ç è¯„å®¡
gitai commit --review

# è‡ªåŠ¨æ·»åŠ æ‰€æœ‰ä¿®æ”¹çš„æ–‡ä»¶
gitai commit --all

# é¢„è§ˆæ¨¡å¼ï¼ˆä¸å®é™…æäº¤ï¼‰
gitai commit --dry-run
```

### é«˜çº§ç”¨æ³•

```bash
# ç»“åˆå¤šä¸ªé€‰é¡¹
gitai commit --review --issue-id "#789" --all

# å¯ç”¨ Tree-sitter åˆ†æï¼ˆåœ¨è¯„å®¡ä¸­ï¼‰
gitai commit --review --tree-sitter

# æŒ‡å®š DevOps ç©ºé—´ ID
gitai commit --space-id 12345 --issue-id "#101"
```

## MCP æ˜ å°„

- å¯¹åº”å·¥å…·ï¼šcommit æœåŠ¡çš„ `execute_commit`
- è¯´æ˜ï¼šå½“ review=true æ—¶ï¼Œtree_sitter æ‰ç”¨äºè¯„å®¡ç¯èŠ‚

ç¤ºä¾‹è¯·æ±‚ï¼š
```json
{
  "name": "execute_commit",
  "arguments": {
    "issue_ids": ["#123"],
    "review": true,
    "tree_sitter": true,
    "add_all": true
  }
}
```

## é…ç½®é€‰é¡¹

åœ¨ `~/.config/gitai/config.toml` ä¸­é…ç½®ï¼š

```toml
[commit]
# é»˜è®¤æ˜¯å¦è¿›è¡Œä»£ç è¯„å®¡
default_review = false

# é»˜è®¤æ˜¯å¦æ·»åŠ æ‰€æœ‰æ–‡ä»¶
default_add_all = false

# æäº¤ä¿¡æ¯æ¨¡æ¿
template = """
{{type}}{{scope}}: {{subject}}

{{body}}

{{footer}}
"""

# AI ç”Ÿæˆå‚æ•°
[commit.ai]
# ç”Ÿæˆçš„æäº¤ä¿¡æ¯é£æ ¼
style = "conventional"  # conventional, angular, atom, eslint

# æœ€å¤§æäº¤ä¿¡æ¯é•¿åº¦
max_length = 100

# åŒ…å«çš„ä¸Šä¸‹æ–‡ä¿¡æ¯
include_context = true
```

## å·¥ä½œæµç¨‹

### 1. å˜æ›´åˆ†æ
```
ä»£ç å˜æ›´ â†’ Git Diff è·å– â†’ æ–‡ä»¶ç±»å‹è¯†åˆ« â†’ å˜æ›´èŒƒå›´åˆ†æ
```

### 2. ä¸Šä¸‹æ–‡æ”¶é›†
```
Issue ä¿¡æ¯è·å– â†’ DevOps ä»»åŠ¡ä¸Šä¸‹æ–‡ â†’ é¡¹ç›®é…ç½®è¯»å– â†’ å†å²æäº¤åˆ†æ
```

### 3. AI ç”Ÿæˆ
```
æ„å»ºæç¤ºè¯ â†’ è°ƒç”¨ AI æ¨¡å‹ â†’ è§£æç”Ÿæˆç»“æœ â†’ æ ¼å¼åŒ–æäº¤ä¿¡æ¯
```

### 4. æäº¤æ‰§è¡Œ
```
å¯é€‰ä»£ç è¯„å®¡ â†’ æ–‡ä»¶æš‚å­˜ â†’ æ‰§è¡Œ Git Commit â†’ è®°å½•æ—¥å¿—
```

## ç¤ºä¾‹åœºæ™¯

### åœºæ™¯ 1ï¼šä¿®å¤ Bug å¹¶å…³è” Issue

```bash
# ä¿®æ”¹ä»£ç å
gitai commit --issue-id "#42" --review

# è¾“å‡ºç¤ºä¾‹ï¼š
ğŸ” æ­£åœ¨åˆ†æä»£ç å˜æ›´...
âœ… ä»£ç è¯„å®¡é€šè¿‡ï¼ˆè¯„åˆ†ï¼š8.5/10ï¼‰
ğŸ“ ç”Ÿæˆæäº¤ä¿¡æ¯ï¼š
fix(parser): resolve null pointer exception in AST traversal

- Add null check before accessing node children
- Update error handling in visitor pattern
- Add unit tests for edge cases

Fixes #42

ğŸ’¾ æäº¤æˆåŠŸï¼
```

### åœºæ™¯ 2ï¼šæ·»åŠ æ–°åŠŸèƒ½

```bash
gitai commit --all

# è¾“å‡ºç¤ºä¾‹ï¼š
ğŸ” æ­£åœ¨åˆ†æä»£ç å˜æ›´...
ğŸ“ ç”Ÿæˆæäº¤ä¿¡æ¯ï¼š
feat(auth): implement JWT token refresh mechanism

- Add token refresh endpoint
- Implement automatic token renewal
- Update authentication middleware
- Add refresh token storage

âœ¨ æäº¤æˆåŠŸï¼
```

### åœºæ™¯ 3ï¼šé‡æ„ä»£ç 

```bash
gitai commit --review --tree-sitter

# è¾“å‡ºç¤ºä¾‹ï¼š
ğŸ” æ­£åœ¨è¿›è¡Œæ·±åº¦ä»£ç åˆ†æ...
ğŸŒ³ Tree-sitter ç»“æ„åˆ†æå®Œæˆ
âœ… ä»£ç è¯„å®¡é€šè¿‡ï¼ˆè¯„åˆ†ï¼š9.0/10ï¼‰
ğŸ“ ç”Ÿæˆæäº¤ä¿¡æ¯ï¼š
refactor(core): extract common utilities to shared module

- Move string utilities to utils/string.rs
- Extract validation logic to validators module
- Reduce code duplication by 40%
- Improve module cohesion

ğŸ’¾ æäº¤æˆåŠŸï¼
```

## æœ€ä½³å®è·µ

### 1. æäº¤ä¿¡æ¯è§„èŒƒ
- ä½¿ç”¨æ˜ç¡®çš„ç±»å‹å‰ç¼€ï¼ˆfeat/fix/docs ç­‰ï¼‰
- ä¿æŒä¸»é¢˜è¡Œç®€æ´ï¼ˆ50 å­—ç¬¦ä»¥å†…ï¼‰
- åœ¨æ­£æ–‡ä¸­è¯¦ç»†è¯´æ˜å˜æ›´åŸå› å’Œå½±å“
- å…³è”ç›¸å…³çš„ Issue æˆ–ä»»åŠ¡

### 2. ä½¿ç”¨ AI å¢å¼º
- è®© AI ç”Ÿæˆåˆç¨¿ï¼Œäººå·¥å®¡æ ¸ä¿®æ”¹
- åˆ©ç”¨ --review é€‰é¡¹ç¡®ä¿ä»£ç è´¨é‡
- ä½¿ç”¨ --dry-run é¢„è§ˆæäº¤æ•ˆæœ

### 3. å›¢é˜Ÿåä½œ
- ç»Ÿä¸€é…ç½®æäº¤ä¿¡æ¯æ¨¡æ¿
- è®¾ç½®å›¢é˜Ÿå…±äº«çš„ AI å‚æ•°
- å®šæœŸæ›´æ–° Issue å…³è”è§„åˆ™

## æ•…éšœæ’é™¤

### é—®é¢˜ï¼šAI ç”Ÿæˆçš„æäº¤ä¿¡æ¯ä¸å‡†ç¡®

**è§£å†³æ–¹æ¡ˆï¼š**
1. ç¡®ä¿ AI æ¨¡å‹é…ç½®æ­£ç¡®
2. æä¾›æ›´å¤šä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆå¦‚ Issue IDï¼‰
3. è°ƒæ•´ AI æ¸©åº¦å‚æ•°ï¼ˆtemperatureï¼‰
4. ä½¿ç”¨ -m æ‰‹åŠ¨æŒ‡å®šå…³é”®ä¿¡æ¯

### é—®é¢˜ï¼šIssue å…³è”å¤±è´¥

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ DevOps é…ç½®æ˜¯å¦æ­£ç¡®
2. éªŒè¯ Issue ID æ ¼å¼
3. ç¡®è®¤æœ‰è®¿é—®æƒé™
4. æŸ¥çœ‹æ—¥å¿—äº†è§£è¯¦ç»†é”™è¯¯

### é—®é¢˜ï¼šæäº¤è¢«æ‹’ç»

**è§£å†³æ–¹æ¡ˆï¼š**
1. ä½¿ç”¨ --review æ£€æŸ¥ä»£ç è´¨é‡
2. ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
3. æ£€æŸ¥æäº¤é’©å­ï¼ˆcommit hooksï¼‰é…ç½®
4. éªŒè¯åˆ†æ”¯ä¿æŠ¤è§„åˆ™

## æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜æœºåˆ¶
- AI å“åº”ç¼“å­˜ï¼šé¿å…é‡å¤åˆ†æç›¸åŒå˜æ›´
- Issue ä¿¡æ¯ç¼“å­˜ï¼šå‡å°‘ API è°ƒç”¨
- é…ç½®ç¼“å­˜ï¼šåŠ å¿«å¯åŠ¨é€Ÿåº¦

### å¹¶å‘å¤„ç†
- å¹¶è¡Œè·å– Issue ä¿¡æ¯
- å¼‚æ­¥æ‰§è¡Œä»£ç åˆ†æ
- æ‰¹é‡å¤„ç†æ–‡ä»¶å˜æ›´

## ä¸å…¶ä»–åŠŸèƒ½é›†æˆ

### ä»£ç è¯„å®¡
```bash
# å…ˆè¯„å®¡åæäº¤
gitai review && gitai commit
```

### å®‰å…¨æ‰«æ
```bash
# æ‰«æåå®‰å…¨æäº¤
gitai scan && gitai commit --review
```

### è´¨é‡åº¦é‡
```bash
# æäº¤åè®°å½•åº¦é‡
gitai commit && gitai metrics record
```

## æœªæ¥å±•æœ›

- [ ] æ”¯æŒæäº¤ä¿¡æ¯æ¨¡æ¿å¸‚åœº
- [ ] é›†æˆæ›´å¤š DevOps å¹³å°
- [ ] æ”¯æŒæäº¤ä¿¡æ¯ç¿»è¯‘
- [ ] æ·»åŠ æäº¤å†å²åˆ†æ
- [ ] å®ç°æ™ºèƒ½å†²çªè§£å†³
